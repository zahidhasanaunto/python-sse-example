<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>SSE Client</title>
    <script>
        // Function to start the SSE connection
        function startSSE(userId) {
            const eventSource = new EventSource(`http://127.0.0.1:5000/events?user_id=${userId}`);

            let str_msg = "";

            eventSource.onmessage = function (event) {
                console.log('Event:', event.data);
                let msg = JSON.parse(event.data);

                if (msg.type === "answer_completed") {
                    console.log("Answer is completed", msg.id_two);
                } else if (msg.type === "answer") {
                    document.getElementById("messages").innerHTML = `<div>${msg.answer}</div>`;
                }
            };

            eventSource.onerror = function (err) {
                console.error('EventSource failed:', err);
                eventSource.close();
            };
        }
    </script>
</head>

<body>
    <h1>Server-Sent Events (SSE) Client</h1>
    <input type="text" id="userId" placeholder="Enter user ID" />
    <button onclick="startSSE(document.getElementById('userId').value)">Connect</button>
    <div id="messages"></div>
</body>

</html>